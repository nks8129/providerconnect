"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[508],{11508:function(e,t,i){i.r(t),i.d(t,{useInteractionsStore:function(){return o}});var n=i(3011),r=i(89134),a=i(88854),d=i(93448),c=i(35729);let o=(0,n.U)()((0,r.tJ)((e,t)=>({interactions:[],isHydrated:!1,setHydrated:()=>e({isHydrated:!0}),setInteractions:t=>e({interactions:t}),addInteraction:t=>{var i,n,r;let a=new Date().toISOString(),o=c.qr.getState(),s={...t,id:(0,d.Ox)("int"),createdBy:t.createdBy||(null===(i=o.currentUser)||void 0===i?void 0:i.id)||"system",createdAt:a};return e(e=>({interactions:[s,...e.interactions]})),o.addAuditEvent({id:(0,d.Ox)("audit"),entityType:"interaction",entityId:s.id,action:"created",actorId:(null===(n=o.currentUser)||void 0===n?void 0:n.id)||"system",timestamp:a,metadata:{type:s.type,providerId:s.providerId,caseId:s.caseId},description:"".concat(s.type," interaction logged")}),s.caseId&&o.addAuditEvent({id:(0,d.Ox)("audit"),entityType:"case",entityId:s.caseId,action:"interaction_linked",actorId:(null===(r=o.currentUser)||void 0===r?void 0:r.id)||"system",timestamp:a,metadata:{interactionId:s.id,type:s.type},description:"".concat(s.type," interaction linked to case")}),s},updateInteraction:(t,i)=>{e(e=>({interactions:e.interactions.map(e=>e.id===t?{...e,...i}:e)}))},deleteInteraction:t=>{e(e=>({interactions:e.interactions.filter(e=>e.id!==t)}))},getInteraction:e=>t().interactions.find(t=>t.id===e),getInteractionsByProvider:e=>t().interactions.filter(t=>t.providerId===e).sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()),getInteractionsByCase:e=>t().interactions.filter(t=>t.caseId===e).sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()),getRecentInteractions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return t().interactions.slice().sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()).slice(0,e)},getFilteredInteractions:e=>{var i,n;let r=t().interactions;if(e.search){let t=e.search.toLowerCase();r=r.filter(e=>e.summary.toLowerCase().includes(t)||e.notes.toLowerCase().includes(t)||e.participants.some(e=>e.toLowerCase().includes(t)))}return e.providerId&&(r=r.filter(t=>t.providerId===e.providerId)),e.caseId&&(r=r.filter(t=>t.caseId===e.caseId)),e.type&&e.type.length>0&&(r=r.filter(t=>e.type.includes(t.type))),e.direction&&e.direction.length>0&&(r=r.filter(t=>e.direction.includes(t.direction))),e.sentiment&&e.sentiment.length>0&&(r=r.filter(t=>e.sentiment.includes(t.sentiment))),(null===(i=e.dateRange)||void 0===i?void 0:i.start)&&(r=r.filter(t=>new Date(t.occurredAt)>=new Date(e.dateRange.start))),(null===(n=e.dateRange)||void 0===n?void 0:n.end)&&(r=r.filter(t=>new Date(t.occurredAt)<=new Date(e.dateRange.end))),r.sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime())},linkToCase:(t,i)=>{var n;let r=new Date().toISOString();e(e=>({interactions:e.interactions.map(e=>e.id===t?{...e,caseId:i}:e)}));let a=c.qr.getState();a.addAuditEvent({id:(0,d.Ox)("audit"),entityType:"case",entityId:i,action:"interaction_linked",actorId:(null===(n=a.currentUser)||void 0===n?void 0:n.id)||"system",timestamp:r,metadata:{interactionId:t},description:"Interaction linked to case"})},unlinkFromCase:t=>{e(e=>({interactions:e.interactions.map(e=>e.id===t?{...e,caseId:null}:e)}))}}),{name:a.I.INTERACTIONS,onRehydrateStorage:()=>e=>{null==e||e.setHydrated()}}))}}]);